컨텍스트 스위칭에 대해 설명해보세요.

---

# 컨텍스트 스위칭 (Context Swiching)

- 컨텍스트 스위칭은 PCB를 기반으로 프로세스의 상태를 저장하고 로드시키는 과정
- 한 프로세스에 할당된 시간이 끝나거나 인터럽트에 의해 발생
- 컴퓨터는 많은 프로그램을 동시에 실행하는 것처럼 보이지만 특정 시점에서 실행되고 있는 프로세스는 단 한 개임
- 많은 프로세스가 동시에 구동 되는 것처럼 보이는 것은 다른 프로세스와의 컨텍스트 스위칭이 아주 빠른 속도로 실행되기 때문
- 현대에는 컴퓨터가 멀티코어 CPU를 가지므로 한 시점에 한 개의 프로그램이라는 설명은 틀린 설명임
- 하지만, 컨텍스트 스위칭을 설명할 때는 싱글코어 기준으로 설명할 예정

## 싱글 코어에서 컨텍스트 스위칭

![Context Swiching](img/context_swiching.png)

- 프로세스 A가 실행하다 멈추고, 프로세스 A의 PCB를 저장하고 다시 프로세스 B를 로드하여 실행
- 다시 프로세스 B의 PCB를 저장하고 프로세스 A의 PCB를 로드 후 실행
- 컨텍스트 스위칭이 일어날 때는 유휴 시간(Idle Time)이 발생
- 뿐만 아니라 캐시미스라는 스위칭 비용이 더 듦

### 유휴 시간(Idle Time)

- 컨텍스트 스위칭 중 CPU가 현재 프로세스 상태를 저장하고 다음 프로세스의 상태를 복원하는 작업
- 프로세스 실행하는 것이 아닌 운영체제의 내부 작업을 수행
- 사용자 입장에서는 아무 작업도 하지 않는 것처럼 보이기 때문에 유휴 시간이라고 함

### 캐시미스(Cache Miss)

- 컨텍스트 스위칭으로 필요한 데이터가 캐시에 없어 메모리에서 가져오는 현상
- CPU 성능 향상을 위해 자주 사용하는 데이터를 캐시에 저장
- 컨텍스트 스위칭이 발생할 때 잘못된 주소 변환을 방지하기 위해 캐시 클리어 과정을 함께 실행
- 컨텍스트 스위칭이 자주 발생할 수록 캐시 미스로 인해 메모리 접근 시간을 증가시켜 전체 시스템의 성능 저하를 초래 

## 스레드에서의 컨텍스트 스위칭

- 컨텍스트 스위칭은 스레드에서도 발생
- 스레드는 스택 영역을 제외한 모든 메모리를 공유하므로 컨텍스트 스위칭 비용이 더 적음
- 즉, 시간이 적게 걸림

# PCB (Process Control Block)

- 프로세스를 관리하기 위해 사용하는 데이터 구조
- 즉, 프로세스의 메타데이터(PID, Status, 명령어 주소, 메모리 정보, 스케쥴링 등)를 저장하는 데이터
- 프로세스의 중요 정보를 포함하기 때문에 일반 사용자가 접근하지 못하도록 커널 스택의 가장 앞부분에서 관리
- 프로세스 제어 블록이라고도 말함
- 프로그램이 실행되면 프로세스가 생성되고 운영체제가 PCB를 생성하여 프로세스에 PCB를 할당함

> ### **메타데이터(Meta Data)**
> - 데이터를 설명하는 작은 데이터들이 구조화된 데이터
> - 대량의 정보 가운데 찾고자 하는 정보를 효율적으로 찾기 위해 일정한 규칙 부여되는 데이터

## PCB 구조

- 프로세스 ID (PID)
  - 자신의 프로세스 ID와 자식 프로세스 ID
- 프로세스 상태
  - '준비', '일시중단' 등 프로세스가 CPU에 대한 소유권을 얻은 이후의 현재 상태 정보
- 프로세스 권한
  - 컴퓨터 자원 또는 I/O 디바이스에 대한 권한 정보
- 프로그램 카운터
  - 프로세스에서 실행해야 할 다음 명령어의 주소에 대한 포인터
- CPU 레지스터
  - 프로세스를 실행하기 위해 저장해야 할 레지스터에 대한 정보
  - 프로세스가 CPU를 사용하다가 중단되면 다시 이어서 할 수 있음
- 메모리 정보
  - 프로세스가 사용하는 메모리 번위, 페이지 테이블 등
- I/O 상태 정보
  - 프로세스에 할당된 I/O 디바이스 목록
- CPU 스케줄링 정보
  - CPU 스케줄러에 의해 중단된 시간 등에 대한 정보
- 계정 정보
  - 프로세스 실행에 사용된 CPU 사용량, 실행한 유저의 정보
